{"version":3,"sources":["../static/js/10.f826cc73.chunk.js","pages/auth/sagas.js","domain/env/sagas.js"],"names":["webpackJsonp","331","module","__webpack_exports__","__webpack_require__","_callee","query","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default","a","wrap","_context","prev","next","__WEBPACK_IMPORTED_MODULE_2_query_string___default","parse","window","location","search","Object","__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__","__WEBPACK_IMPORTED_MODULE_3_domain_env_sagas__","stop","_marked","this","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__","n","__WEBPACK_IMPORTED_MODULE_2_query_string__","mark","348","version","db","__WEBPACK_IMPORTED_MODULE_4_lib_db__","sent","__WEBPACK_IMPORTED_MODULE_5__envActions__","clearDB","payload","_context2","type","success","reload","t0","failure","err","_marked2","ensureSignIn","params","_ref","access_token","envList","_context3","__WEBPACK_IMPORTED_MODULE_3_domain_api__","auth","data","key","__WEBPACK_IMPORTED_MODULE_7__helpers__","ENV","__WEBPACK_IMPORTED_MODULE_2_react_router_redux__","pathname","_marked3","d"],"mappings":"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","file":"static/js/10.f826cc73.chunk.js","sourcesContent":["webpackJsonp([10],{\n\n/***/ 331:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (immutable) */ __webpack_exports__[\"default\"] = _callee;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_query_string__ = __webpack_require__(124);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_query_string___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_query_string__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_domain_env_sagas__ = __webpack_require__(348);\nvar _marked=/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(_callee);function _callee(){var query;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:query=__WEBPACK_IMPORTED_MODULE_2_query_string___default.a.parse(window.location.search);_context.next=3;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"b\" /* call */])(__WEBPACK_IMPORTED_MODULE_3_domain_env_sagas__[\"c\" /* ensureSignIn */],query);case 3:case'end':return _context.stop();}}},_marked,this);}\n\n/***/ }),\n\n/***/ 348:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"d\"] = version;\n/* harmony export (immutable) */ __webpack_exports__[\"b\"] = clearDB;\n/* harmony export (immutable) */ __webpack_exports__[\"c\"] = ensureSignIn;\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_react_router_redux__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_domain_api__ = __webpack_require__(68);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lib_db__ = __webpack_require__(18);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__envActions__ = __webpack_require__(27);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__envSelector__ = __webpack_require__(65);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__helpers__ = __webpack_require__(123);\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_5__envActions__; });\n/* unused harmony reexport selector */\nvar _marked=/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(version),_marked2=/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(clearDB),_marked3=/*#__PURE__*/__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(ensureSignIn);function version(){var db;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function version$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"b\" /* call */])(__WEBPACK_IMPORTED_MODULE_4_lib_db__[\"m\" /* version */]);case 2:db=_context.sent;_context.next=5;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"e\" /* put */])(__WEBPACK_IMPORTED_MODULE_5__envActions__[\"version\"](db));case 5:case'end':return _context.stop();}}},_marked,this);}function clearDB(){var payload;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function clearDB$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"b\" /* call */])(__WEBPACK_IMPORTED_MODULE_4_lib_db__[\"d\" /* clean */]);case 3:payload=_context2.sent;_context2.next=6;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"e\" /* put */])({type:__WEBPACK_IMPORTED_MODULE_5__envActions__[\"clearDB\"].success,payload:payload});case 6:window.location.reload();_context2.next=13;break;case 9:_context2.prev=9;_context2.t0=_context2['catch'](0);_context2.next=13;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"e\" /* put */])({type:__WEBPACK_IMPORTED_MODULE_5__envActions__[\"clearDB\"].failure,err:_context2.t0});case 13:case'end':return _context2.stop();}}},_marked2,this,[[0,9]]);}function ensureSignIn(params){var _ref,access_token,envList;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function ensureSignIn$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"b\" /* call */])(__WEBPACK_IMPORTED_MODULE_3_domain_api__[\"a\" /* default */].auth,{params:params});case 3:_ref=_context3.sent;access_token=_ref.data.access_token;envList=[{key:'user',value:{access_token:access_token}},{key:'isAuthorized',value:true}];_context3.next=8;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"e\" /* put */])({type:__WEBPACK_IMPORTED_MODULE_5__envActions__[\"signIn\"].success,payload:Object(__WEBPACK_IMPORTED_MODULE_7__helpers__[\"a\" /* envSerialize */])(envList)});case 8:_context3.next=10;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"b\" /* call */])(__WEBPACK_IMPORTED_MODULE_4_lib_db__[\"c\" /* addList */],__WEBPACK_IMPORTED_MODULE_4_lib_db__[\"a\" /* TABLE */].ENV,envList);case 10:_context3.next=12;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"e\" /* put */])(Object(__WEBPACK_IMPORTED_MODULE_2_react_router_redux__[\"d\" /* replace */])({pathname:'/',search:''}));case 12:_context3.next=18;break;case 14:_context3.prev=14;_context3.t0=_context3['catch'](0);_context3.next=18;return Object(__WEBPACK_IMPORTED_MODULE_1_redux_saga_effects__[\"e\" /* put */])({type:__WEBPACK_IMPORTED_MODULE_5__envActions__[\"signIn\"].success,err:_context3.t0});case 18:case'end':return _context3.stop();}}},_marked3,this,[[0,14]]);}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/10.f826cc73.chunk.js","import { call } from 'redux-saga/effects';\nimport qs from 'query-string';\nimport * as Env from 'domain/env/sagas';\n\nexport default function* () {\n  const query = qs.parse(window.location.search);\n  yield call(Env.ensureSignIn, query);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/auth/sagas.js","import { call, put } from 'redux-saga/effects';\nimport { replace } from 'react-router-redux';\nimport Api from 'domain/api';\nimport * as idb from 'lib/db';\nimport * as action from './envActions';\nimport * as selector from './envSelector';\nimport { envSerialize } from './helpers';\nexport { action, selector };\n\nexport function* version() {\n  const db = yield call(idb.version);\n  yield put(action.version(db));\n}\n\nexport function* clearDB() {\n  try {\n    const payload = yield call(idb.clean);\n    yield put({\n      type: action.clearDB.success,\n      payload,\n    });\n    window.location.reload();\n  } catch (err) {\n    yield put({\n      type: action.clearDB.failure,\n      err,\n    });\n  }\n}\n\nexport function* ensureSignIn(params) {\n  try {\n\n    const { data: { access_token } } = yield call(Api.auth, { params });\n\n    const envList = [\n      {\n        key: 'user', value: {\n          access_token,\n        },\n      }, {\n        key: 'isAuthorized',\n        value: true,\n      },\n    ];\n\n    yield put({\n      type: action.signIn.success,\n      payload: envSerialize(envList),\n    });\n\n    yield call(idb.addList, idb.TABLE.ENV, envList);\n\n    yield put(\n      replace({\n        pathname: '/',\n        search: '',\n      }),\n    );\n\n  } catch (err) {\n    yield put({\n      type: action.signIn.success,\n      err,\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/domain/env/sagas.js"],"sourceRoot":""}